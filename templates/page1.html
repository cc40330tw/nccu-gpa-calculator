{% extends 'layout.html' %}

{% block head %}
<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='style1.css') }}">

<script src="jquery.js"></script>

<script type="module" >

  // import { score_to_gpa_4point3 } from './score_to_gpa.js';
  // 一開始就算一次
  window.addEventListener('load', calculate_gpa ,false);

  // 計算的function
  function calculate_gpa() {
    
    var total_score_4point3 = 0;
    var total_score_4 = 0;
    var total_credit = 2;
    // var total_credit0 = score_to_gpa_4point3(total_credit);
    var gpa0 = 0;

    var course = document.getElementsByClassName("course");
    
    // for (var i = 0; i < course.length; i++) {
      
    //   if (course[i].checked) {
    //     var row = course[i].parentNode.parentNode;
    //     credit = row.getElementsByTagName("td")[6].textContent
    //     score = row.getElementsByTagName("td")[7].textContent
    //     total_credit += parseInt(parseFloat(credit)) 
    //     total_credit0 += score_to_gpa_4point3(total_credit)
    //     // total_score_4point3 += score_to_gpa_4point3(parseFloat(score)) * parseInt(parseFloat(credit)) 
    //     // total_score_4 += score_to_gpa_4(float(row[6])) * int(float(row[5].innertHTML)) 
    //   }
    // }
    // alert(total_credit)
    // gpa0 = total_score_4point3/total_credit
	  document.getElementById("gpa0").innerHTML = total_credit;
  }

</script>
{% endblock head %}

{% block body %}
<div id = 'main'>

  <form  action="{{ url_for('result') }}" method="post">
    <div class = 'title'>
      NCCU GPA CALCULATOR
    </div>
</div>

<div >
  <span>GPA</span>
  <span id = "gpa0"></span>
  <!-- GPA {{ gpa0 }} / 4.3 -->
  <!-- GPA {{ gpa1 }} / 4.0 -->
</div>

<table class="table" data-toggle="table">
  <thead>
    <tr>
      <th scope="col"></th>
      <th scope="col">學年</th>
      <th scope="col">學期</th>
      <th scope="col">科目代號</th>
      <th scope="col">科目名稱</th>
      <th scope="col">修別</th>
      <th scope="col">學分數</th>
      <th scope="col">成績</th>
      <th scope="col">備註</th>
    </tr>
  </thead>
        
  <tbody>
    {% for semester in data_all %} 
      <tr class="table-primary">
        <td>{{ semester[0][0] }}</td>
        <td>{{ semester[0][1] }}</td>
      </tr>
      {% for semester_data in semester %}
      <tr>
        <td class="bs-checkbox"><input class="course" type="checkbox" onclick="calculate_gpa()" checked></td>
        <td>{{ semester_data[0] }}</td>
        <td>{{ semester_data[1] }}</td>
        <td>{{ semester_data[2] }}</td>
        <td>{{ semester_data[3] }}</td>
        <td>{{ semester_data[4] }}</td>
        <td class = "credit">{{ semester_data[5] }}</td>
        <td class = "score">{{ semester_data[6] }}</td>
        <td>{{ semester_data[7] }}</td>
      </tr>
      {% endfor %}
    {% endfor %}
  </tbody>
</table>


{% endblock body %}

